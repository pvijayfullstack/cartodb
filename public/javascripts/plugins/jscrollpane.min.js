(function(B,A,C){B.fn.jScrollPane=function(F){function D(c,m){var AX,o=this,x,AJ,V,AL,r,y,Y,R,AY,Ad,AT,J,h,I,K,z,t,AP,w,T,a,AQ,AE,AM,f,M,AS,AW,X,AU,Ag,G,j,AI=true,n=true,Af=false,L=false,AO=c.clone(false,false).empty(),AB=B.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";Ag=c.css("paddingTop")+" "+c.css("paddingRight")+" "+c.css("paddingBottom")+" "+c.css("paddingLeft");G=(parseInt(c.css("paddingLeft"),10)||0)+(parseInt(c.css("paddingRight"),10)||0);function AR(Ap){var An,Ao,Aj,Al,Ak,Ai,Ah,Am;AX=Ap;if(x===C){Ah=c.scrollTop();Am=c.scrollLeft();c.css({overflow:"hidden",padding:0});AJ=c.innerWidth()+G;V=c.innerHeight();c.width(AJ);x=B('<div class="jspPane" />').css("padding",Ag).append(c.children());AL=B('<div class="jspContainer" />').css({width:AJ+"px",height:V+"px"}).append(x).appendTo(c);}else{c.css("width","");Ai=c.innerWidth()+G!=AJ||c.outerHeight()!=V;if(Ai){AJ=c.innerWidth()+G;V=c.innerHeight();AL.css({width:AJ+"px",height:V+"px"});}if(!Ai&&j==r&&x.outerHeight()==y){c.width(AJ);return ;}j=r;x.css("width","");c.width(AJ);AL.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end();}An=x.clone(false,false).css("position","absolute");Ao=B('<div style="width:1px; position: relative;" />').append(An);B("body").append(Ao);r=Math.max(x.outerWidth(),An.outerWidth());Ao.remove();y=x.outerHeight();Y=r/AJ;R=y/V;AY=R>1;Ad=Y>1;if(!(Ad||AY)){c.removeClass("jspScrollable");x.css({top:0,width:AL.width()-G});O();d();p();W();AH();}else{c.addClass("jspScrollable");Aj=AX.maintainPosition&&(h||z);if(Aj){Al=Ab();Ak=AZ();}Ae();Z();e();if(Aj){l(Al,false);k(Ak,false);}i();AF();AN();if(AX.enableKeyboardNavigation){q();}if(AX.clickOnTrack){Q();}b();if(AX.hijackInternalLinks){N();}}if(AX.autoReinitialise&&!AU){AU=setInterval(function(){AR(AX);},AX.autoReinitialiseDelay);}else{if(!AX.autoReinitialise&&AU){clearInterval(AU);}}Ah&&c.scrollTop(0)&&k(Ah,false);Am&&c.scrollLeft(0)&&l(Am,false);c.trigger("jsp-initialised",[Ad||AY]);}function Ae(){if(AY){AL.append(B('<div class="jspVerticalBar" />').append(B('<div class="jspCap jspCapTop" />'),B('<div class="jspTrack" />').append(B('<div class="jspDrag" />').append(B('<div class="jspDragTop" />'),B('<div class="jspDragBottom" />'))),B('<div class="jspCap jspCapBottom" />')));t=AL.find(">.jspVerticalBar");AP=t.find(">.jspTrack");AT=AP.find(">.jspDrag");if(AX.showArrows){AQ=B('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",Ac(0,-1)).bind("click.jsp",Aa);AE=B('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",Ac(0,1)).bind("click.jsp",Aa);if(AX.arrowScrollOnHover){AQ.bind("mouseover.jsp",Ac(0,-1,AQ));AE.bind("mouseover.jsp",Ac(0,1,AE));}AK(AP,AX.verticalArrowPositions,AQ,AE);}T=V;AL.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){T-=B(this).outerHeight();});AT.hover(function(){AT.addClass("jspHover");},function(){AT.removeClass("jspHover");}).bind("mousedown.jsp",function(Ah){B("html").bind("dragstart.jsp selectstart.jsp",Aa);AT.addClass("jspActive");var s=Ah.pageY-AT.position().top;B("html").bind("mousemove.jsp",function(Ai){u(Ai.pageY-s,false);}).bind("mouseup.jsp mouseleave.jsp",AV);return false;});P();}}function P(){AP.height(T+"px");h=0;w=AX.verticalGutter+AP.outerWidth();x.width(AJ-w-G);if(t.position().left===0){x.css("margin-left",w+"px");}}function Z(){if(Ad){AL.append(B('<div class="jspHorizontalBar" />').append(B('<div class="jspCap jspCapLeft" />'),B('<div class="jspTrack" />').append(B('<div class="jspDrag" />').append(B('<div class="jspDragLeft" />'),B('<div class="jspDragRight" />'))),B('<div class="jspCap jspCapRight" />')));AM=AL.find(">.jspHorizontalBar");f=AM.find(">.jspTrack");I=f.find(">.jspDrag");if(AX.showArrows){AW=B('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",Ac(-1,0)).bind("click.jsp",Aa);X=B('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",Ac(1,0)).bind("click.jsp",Aa);if(AX.arrowScrollOnHover){AW.bind("mouseover.jsp",Ac(-1,0,AW));X.bind("mouseover.jsp",Ac(1,0,X));}AK(f,AX.horizontalArrowPositions,AW,X);}I.hover(function(){I.addClass("jspHover");},function(){I.removeClass("jspHover");}).bind("mousedown.jsp",function(Ah){B("html").bind("dragstart.jsp selectstart.jsp",Aa);I.addClass("jspActive");var s=Ah.pageX-I.position().left;B("html").bind("mousemove.jsp",function(Ai){v(Ai.pageX-s,false);}).bind("mouseup.jsp mouseleave.jsp",AV);return false;});M=AL.innerWidth();AG();}}function AG(){AL.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){M-=B(this).outerWidth();});f.width(M+"px");z=0;}function e(){if(Ad&&AY){var Ah=f.outerHeight(),s=AP.outerWidth();T-=Ah;B(AM).find(">.jspCap:visible,>.jspArrow").each(function(){M+=B(this).outerWidth();});M-=s;V-=s;AJ-=Ah;f.parent().append(B('<div class="jspCorner" />').css("width",Ah+"px"));P();AG();}if(Ad){x.width((AL.outerWidth()-G)+"px");}y=x.outerHeight();R=y/V;if(Ad){AS=Math.ceil(1/Y*M);if(AS>AX.horizontalDragMaxWidth){AS=AX.horizontalDragMaxWidth;}else{if(AS<AX.horizontalDragMinWidth){AS=AX.horizontalDragMinWidth;}}I.width(AS+"px");K=M-AS;AD(z);}if(AY){a=Math.ceil(1/R*T);if(a>AX.verticalDragMaxHeight){a=AX.verticalDragMaxHeight;}else{if(a<AX.verticalDragMinHeight){a=AX.verticalDragMinHeight;}}AT.height(a+"px");J=T-a;AC(h);}}function AK(Ai,Ak,Ah,s){var Am="before",Aj="after",Al;if(Ak=="os"){Ak=/Mac/.test(navigator.platform)?"after":"split";}if(Ak==Am){Aj=Ak;}else{if(Ak==Aj){Am=Ak;Al=Ah;Ah=s;s=Al;}}Ai[Am](Ah)[Aj](s);}function Ac(Ah,s,Ai){return function(){g(Ah,s,this,Ai);this.blur();return false;};}function g(Ak,Aj,An,Am){An=B(An).addClass("jspActive");var Al,Ai,Ah=true,s=function(){if(Ak!==0){o.scrollByX(Ak*AX.arrowButtonSpeed);}if(Aj!==0){o.scrollByY(Aj*AX.arrowButtonSpeed);}Ai=setTimeout(s,Ah?AX.initialDelay:AX.arrowRepeatFreq);Ah=false;};s();Al=Am?"mouseout.jsp":"mouseup.jsp";Am=Am||B("html");Am.bind(Al,function(){An.removeClass("jspActive");Ai&&clearTimeout(Ai);Ai=null;Am.unbind(Al);});}function Q(){W();if(AY){AP.bind("mousedown.jsp",function(Am){if(Am.originalTarget===C||Am.originalTarget==Am.currentTarget){var Ak=B(this),An=Ak.offset(),Al=Am.pageY-An.top-h,Ai,Ah=true,s=function(){var Aq=Ak.offset(),Ar=Am.pageY-Aq.top-a/2,Ao=V*AX.scrollPagePercent,Ap=J*Ao/(y-V);if(Al<0){if(h-Ap>Ar){o.scrollByY(-Ao);}else{u(Ar);}}else{if(Al>0){if(h+Ap<Ar){o.scrollByY(Ao);}else{u(Ar);}}else{Aj();return ;}}Ai=setTimeout(s,Ah?AX.initialDelay:AX.trackClickRepeatFreq);Ah=false;},Aj=function(){Ai&&clearTimeout(Ai);Ai=null;B(document).unbind("mouseup.jsp",Aj);};s();B(document).bind("mouseup.jsp",Aj);return false;}});}if(Ad){f.bind("mousedown.jsp",function(Am){if(Am.originalTarget===C||Am.originalTarget==Am.currentTarget){var Ak=B(this),An=Ak.offset(),Al=Am.pageX-An.left-z,Ai,Ah=true,s=function(){var Aq=Ak.offset(),Ar=Am.pageX-Aq.left-AS/2,Ao=AJ*AX.scrollPagePercent,Ap=K*Ao/(r-AJ);if(Al<0){if(z-Ap>Ar){o.scrollByX(-Ao);}else{v(Ar);}}else{if(Al>0){if(z+Ap<Ar){o.scrollByX(Ao);}else{v(Ar);}}else{Aj();return ;}}Ai=setTimeout(s,Ah?AX.initialDelay:AX.trackClickRepeatFreq);Ah=false;},Aj=function(){Ai&&clearTimeout(Ai);Ai=null;B(document).unbind("mouseup.jsp",Aj);};s();B(document).bind("mouseup.jsp",Aj);return false;}});}}function W(){if(f){f.unbind("mousedown.jsp");}if(AP){AP.unbind("mousedown.jsp");}}function AV(){B("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(AT){AT.removeClass("jspActive");}if(I){I.removeClass("jspActive");}}function u(s,Ah){if(!AY){return ;}if(s<0){s=0;}else{if(s>J){s=J;}}if(Ah===C){Ah=AX.animateScroll;}if(Ah){o.animate(AT,"top",s,AC);}else{AT.css("top",s);AC(s);}}function AC(Ah){if(Ah===C){Ah=AT.position().top;}AL.scrollTop(0);h=Ah;var Ak=h===0,Ai=h==J,Aj=Ah/J,s=-Aj*(y-V);if(AI!=Ak||Af!=Ai){AI=Ak;Af=Ai;c.trigger("jsp-arrow-change",[AI,Af,n,L]);}U(Ak,Ai);x.css("top",s);c.trigger("jsp-scroll-y",[-s,Ak,Ai]).trigger("scroll");}function v(Ah,s){if(!Ad){return ;}if(Ah<0){Ah=0;}else{if(Ah>K){Ah=K;}}if(s===C){s=AX.animateScroll;}if(s){o.animate(I,"left",Ah,AD);}else{I.css("left",Ah);AD(Ah);}}function AD(Ah){if(Ah===C){Ah=I.position().left;}AL.scrollTop(0);z=Ah;var Ak=z===0,Aj=z==K,Ai=Ah/K,s=-Ai*(r-AJ);if(n!=Ak||L!=Aj){n=Ak;L=Aj;c.trigger("jsp-arrow-change",[AI,Af,n,L]);}S(Ak,Aj);x.css("left",s);c.trigger("jsp-scroll-x",[-s,Ak,Aj]).trigger("scroll");}function U(Ah,s){if(AX.showArrows){AQ[Ah?"addClass":"removeClass"]("jspDisabled");AE[s?"addClass":"removeClass"]("jspDisabled");}}function S(Ah,s){if(AX.showArrows){AW[Ah?"addClass":"removeClass"]("jspDisabled");X[s?"addClass":"removeClass"]("jspDisabled");}}function k(s,Ah){var Ai=s/(y-V);u(Ai*J,Ah);}function l(Ah,s){var Ai=Ah/(r-AJ);v(Ai*K,s);}function AA(At,Ao,Ai){var Am,Aj,Ak,s=0,As=0,Ah,An,Aq,Ap,Ar;try{Am=B(At);}catch(Al){return ;}Aj=Am.outerHeight();Ak=Am.outerWidth();AL.scrollTop(0);AL.scrollLeft(0);while(!Am.is(".jspPane")){s+=Am.position().top;As+=Am.position().left;Am=Am.offsetParent();if(/^body|html$/i.test(Am[0].nodeName)){return ;}}Ah=AZ();An=Ah+V;if(s<Ah||Ao){Ap=s-AX.verticalGutter;}else{if(s+Aj>An){Ap=s-V+Aj+AX.verticalGutter;}}if(Ap){k(Ap,Ai);}viewportLeft=Ab();Aq=viewportLeft+AJ;if(As<viewportLeft||Ao){Ar=As-AX.horizontalGutter;}else{if(As+Ak>Aq){Ar=As-AJ+Ak+AX.horizontalGutter;}}if(Ar){l(Ar,Ai);}}function Ab(){return -x.position().left;}function AZ(){return -x.position().top;}function AF(){AL.unbind(AB).bind(AB,function(Ak,Al,Aj,Ah){var Ai=z,s=h;o.scrollBy(Aj*AX.mouseWheelSpeed,-Ah*AX.mouseWheelSpeed,false);return Ai==z&&s==h;});}function O(){AL.unbind(AB);}function Aa(){return false;}function i(){x.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(s){AA(s.target,false);});}function d(){x.find(":input,a").unbind("focus.jsp");}function q(){var s,Ah;x.focus(function(){c.focus();});c.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(Al){if(Al.target!==this){return ;}var Ak=z,Aj=h;switch(Al.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:s=Al.keyCode;Ai();break;case 35:k(y-V);s=null;break;case 36:k(0);s=null;break;}Ah=Al.keyCode==s&&Ak!=z||Aj!=h;return !Ah;}).bind("keypress.jsp",function(Aj){if(Aj.keyCode==s){Ai();}return !Ah;});if(AX.hideFocus){c.css("outline","none");if("hideFocus" in AL[0]){c.attr("hideFocus",true);}}else{c.css("outline","");if("hideFocus" in AL[0]){c.attr("hideFocus",false);}}function Ai(){var Ak=z,Aj=h;switch(s){case 40:o.scrollByY(AX.keyboardSpeed,false);break;case 38:o.scrollByY(-AX.keyboardSpeed,false);break;case 34:case 32:o.scrollByY(V*AX.scrollPagePercent,false);break;case 33:o.scrollByY(-V*AX.scrollPagePercent,false);break;case 39:o.scrollByX(AX.keyboardSpeed,false);break;case 37:o.scrollByX(-AX.keyboardSpeed,false);break;}Ah=Ak!=z||Aj!=h;return Ah;}}function p(){c.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp");}function b(){if(location.hash&&location.hash.length>1){var Ai,Ah;try{Ai=B(location.hash);}catch(s){return ;}if(Ai.length&&x.find(location.hash)){if(AL.scrollTop()===0){Ah=setInterval(function(){if(AL.scrollTop()>0){AA(location.hash,true);B(document).scrollTop(AL.position().top);clearInterval(Ah);}},50);}else{AA(location.hash,true);B(document).scrollTop(AL.position().top);}}}}function AH(){B("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack");}function N(){AH();B("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var s=this.href.split("#"),Ah;if(s.length>1){Ah=s[1];if(Ah.length>0&&x.find("#"+Ah).length>0){AA("#"+Ah,true);return false;}}});}function AN(){var Ai,Ah,Ak,Aj,Al,s=false;AL.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(Am){var An=Am.originalEvent.touches[0];Ai=Ab();Ah=AZ();Ak=An.pageX;Aj=An.pageY;Al=false;s=true;}).bind("touchmove.jsp",function(Ap){if(!s){return ;}var Ao=Ap.originalEvent.touches[0],An=z,Am=h;o.scrollTo(Ai+Ak-Ao.pageX,Ah+Aj-Ao.pageY);Al=Al||Math.abs(Ak-Ao.pageX)>5||Math.abs(Aj-Ao.pageY)>5;return An==z&&Am==h;}).bind("touchend.jsp",function(Am){s=false;}).bind("click.jsp-touchclick",function(Am){if(Al){Al=false;return false;}});}function H(){var s=AZ(),Ah=Ab();c.removeClass("jspScrollable").unbind(".jsp");c.replaceWith(AO.append(x.children()));AO.scrollTop(s);AO.scrollLeft(Ah);}B.extend(o,{reinitialise:function(Ah){Ah=B.extend({},AX,Ah);AR(Ah);},scrollToElement:function(Ai,Ah,s){AA(Ai,Ah,s);},scrollTo:function(Ai,s,Ah){l(Ai,Ah);k(s,Ah);},scrollToX:function(Ah,s){l(Ah,s);},scrollToY:function(s,Ah){k(s,Ah);},scrollToPercentX:function(Ah,s){l(Ah*(r-AJ),s);},scrollToPercentY:function(Ah,s){k(Ah*(y-V),s);},scrollBy:function(Ah,s,Ai){o.scrollByX(Ah,Ai);o.scrollByY(s,Ai);},scrollByX:function(s,Ai){var Ah=Ab()+s,Aj=Ah/(r-AJ);v(Aj*K,Ai);},scrollByY:function(s,Ai){var Ah=AZ()+s,Aj=Ah/(y-V);u(Aj*J,Ai);},positionDragX:function(s,Ah){v(s,Ah);},positionDragY:function(Ah,s){v(Ah,s);},animate:function(Ah,Ak,s,Aj){var Ai={};Ai[Ak]=s;Ah.animate(Ai,{duration:AX.animateDuration,ease:AX.animateEase,queue:false,step:Aj});},getContentPositionX:function(){return Ab();},getContentPositionY:function(){return AZ();},getContentWidth:function(){return r();},getContentHeight:function(){return y();},getPercentScrolledX:function(){return Ab()/(r-AJ);},getPercentScrolledY:function(){return AZ()/(y-V);},getIsScrollableH:function(){return Ad;},getIsScrollableV:function(){return AY;},getContentPane:function(){return x;},scrollToBottom:function(s){u(J,s);},hijackInternalLinks:function(){N();},destroy:function(){H();}});AR(m);}F=B.extend({},B.fn.jScrollPane.defaults,F);B.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){F[this]=F[this]||F.speed;});var E;this.each(function(){var G=B(this),H=G.data("jsp");if(H){H.reinitialise(F);}else{H=new D(G,F);G.data("jsp",H);}E=E?E.add(G):G;});return E;};B.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8};})(jQuery,this);