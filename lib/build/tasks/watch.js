
  /**
   *  Watch/listen for assets
   */

exports.task = function() {
  var js_files = require('../files/js_files');
  var js = [];
  for(var f in js_files) {
    js = js.concat(js_files[f]);
  }

  // watch cdb files
  js.push(['lib/assets/javascripts/cdb/src/**/*.js']);

  return {
    js: {
      files: js,
      tasks: ['cdb', 'concat:js', 'jst'],
      options: {
        spawn: false,
        atBegin: true
      }
    },
    js_core_cartodb3: {
      files: [
        'lib/assets/core/javascripts/cartodb3/**/*',
        '!**/node_modules/**'
      ],
      tasks: ['copy:js_core_cartodb3', 'copy:js_client'],
      options: {
        spawn: false,
        atBegin: false
      }
    },
    js_client_cartodb3: {
      files: [
        'lib/assets/client/javascripts/cartodb3/**/*'
      ],
      tasks: ['copy:js_client_cartodb3'],
      options: {
        spawn: false,
        atBegin: false
      }
    },
    css: {
      files: [
        'assets/stylesheets/**/*.css.scss',
        'app/assets/stylesheets/**/*.css.scss',
        'app/assets/client/stylesheets/**/*.css.scss'
      ],
      tasks: ['css'],
      options: {
        spawn: false,
        atBegin: false
      }
    },
    livereload: {
      files: [
        'public/assets/<%= pkg.version %>/stylesheets/*.css',
        'public/assets/<%= pkg.version %>/javascripts/*.js',

        // makes any open specrunner to re-run tests on test bundles generated by browserify
        '.grunt/browserify_modules_tests.js',
        '.grunt/cartodb3-specs.js'
      ],
      options: {
        livereload: false
      }
    }
  };

};
