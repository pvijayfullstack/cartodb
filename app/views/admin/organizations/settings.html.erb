<% content_for(:page_title) do %>
  Your organization | Public Dashboard Settings
<% end %>
<%= content_for(:js) do %>
  <%= javascript_include_tag 'cdb.js', 'application.js', 'models.js', 'organization.js', 'templates.js' %>
  <script type="text/javascript">
    var username = "<%= current_user.username %>"
      , type = "oauth"
      , config = <%=raw frontend_config.html_safe %>
      , organization_quota = {
          seats: <%= current_user.organization.seats %>,
          quota_in_bytes: <%= current_user.organization.quota_in_bytes %>
        }
      , organization_users = <%= raw @users.map { |u| {
          id: u.id,
          username: u.username,
          quota_in_bytes: u.quota_in_bytes,
          remaining_quota: u.remaining_quota,
          organization_owner: u.organization_owner?
        }}.to_json -%>
      , user_data = <%= raw current_user.data.to_json.html_safe %>;
  </script>
<% end %>
<%= content_for(:css) do %>
  <%= stylesheet_link_tag 'common.css', 'organization.css', :media => 'all' %>
<% end %>

<%= content_for(:account_settings) do %>
  <%= render partial: "settings_account" %>
<% end %>

<%= form_for @organization, url: organization_settings_update_path(user_domain: params[:user_domain]) do |form| %>

    <article>
      <div class="inner">
        <section class="block">
          <div class="content">

            <div class="row">
                <%= form.label :avatar_url %>
                <%= form.text_field :avatar_url, :class => @organization.errors[:avatar_url].present? ? 'error' : nil %>
                <%= form_error_for :avatar_url, @organization.errors %>
            </div>

            <div class="row">
              <%= form.label :website %>
              <%= form.text_field :website, :class => @organization.errors[:website].present? ? 'error' : nil %>
              <%= form_error_for :website, @organization.errors %>
            </div>

            <div class="row">
              <%= form.label :description %>
              <%= form.text_field :description, :class => @organization.errors[:description].present? ? 'error' : nil %>
              <%= form_error_for :description, @organization.errors %>
            </div>

            <div class="row">
              <%= form.label :display_name %>
              <%= form.text_field :display_name, :class => @organization.errors[:display_name].present? ? 'error' : nil %>
              <%= form_error_for :display_name, @organization.errors %>
            </div>

            <div class="row">
              <%= form.label :discus_shortname %>
              <%= form.text_field :discus_shortname, :class => @organization.errors[:discus_shortname].present? ? 'error' : nil %>
              <%= form_error_for :discus_shortname, @organization.errors %>
            </div>

            <div class="row">
              <%= form.label :twitter_username %>
              <%= form.text_field :twitter_username, :class => @organization.errors[:twitter_username].present? ? 'error' : nil %>
              <%= form_error_for :twitter_username, @organization.errors %>
            </div>

          </div>

          <div class="foot">
            <%= form.submit 'Save changes', :class => "right grey button new" %>
          </div>

        </section>
      </div>
    </article>

<% end %>