<% content_for :js do %>
  <%= javascript_include_tag 'sessions.js' %>

  <script>
    $(function() {
      window.Sessions = new App.Views.Sessions();
    });
  </script>
<% end %>

<div class="Sessions">
  <header class="Sessions-header">
    <div class="u-inner">
      <nav class="Navbar">
        <div class="Navbar-header">
          <div class="Navbar-title">
            <picture class="Navbar-brand">
              <source type="image/svg+xml" srcset="<%= image_path "layout/sessions/brand.svg" %>">
              <img src="<%= image_path "layout/sessions/brand.png" %>" alt="CartoDB">
            </picture>
          </div>
        </div>

        <div class="Navbar-collapse">
          <ul class="Navbar-menu u-ilist">
            <li class="Navbar-menuItem u-iblock">
              <a href="<%= login_url %>" class="Navbar-link Btn Btn--m u-tupper"><span>Login</span></a>
            </li>

            <li class="Navbar-menuItem u-iblock">
              <a href="<% if params[:after].present? %><%= signup_path(after: params[:after]) %><% else %><%= "https://cartodb.com/signup" %><% end %>" class="Navbar-link Btn Btn--m Btn--white has-border u-tupper"><span>Sign up</span></a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

  <div class="Sessions-content">
    <div class="Sessions-inner">
      <div class="u-inner">
        <div class="Sessions-left">
          <div class="Sessions-form">
            <h1 class="Sessions-title u-vspace-xs">Login to CartoDB</h1>
            <p class="Sessions-description">Help other people understand the world we live in, with maps.</p>

            <div class="Sessions-sep"></div>

            <% if @google_plus_config.present? %>
              <%= render partial: 'google_plus/google_plus_button',  locals: { config: @google_plus_config } %>
            <% end %>

            <div class="Sessions-sep"></div>

            <%= form_tag create_session_path, class: "js-Loading-form" do %>
              <% @error = @login_error %>

              <input type="hidden" value="" id="google_access_token" name="google_access_token" />

              <div class="Sessions-field">
                <%= text_field_tag :email, CartoDB.extract_subdomain(request), :title => "Email or username", placeholder: "Email or username", class: "Sessions-input" %>

                <% if @error %>
                  <div class="Sessions-fieldError js-Sessions-fieldError" data-content="Email <%= @error[0, 1].downcase + @error.humanize[1..-1] %>.">!</div>
                <% end %>
              </div>

              <div class="Sessions-field">
                <%= password_field_tag :password, "", placeholder: "Password", class: "Sessions-input" %>
                <% if @error %>
                  <div class="Sessions-fieldError js-Sessions-fieldError" data-content="Password <%= @error[0, 1].downcase + @error.humanize[1..-1] %>.">!</div>
                <% end %>
              </div>

              <div class="Sessions-field">
                <p>
                  <button type="submit" class="Btn Btn--green Btn--m is-highlight u-tupper Sessions-button js-Sessions-button js-Loading u-right">
                    <span class="js-Loading-text">Login</span>
                    <span class="js-Loading-anim" style="display: none;">
                      <span class="Loading-item">
                        <span class="Loading-itemInner Loading-itemInner--01"></span>
                      </span>

                      <span class="Loading-item">
                        <span class="Loading-itemInner Loading-itemInner--02"></span>
                      </span>

                      <span class="Loading-item">
                        <span class="Loading-itemInner Loading-itemInner--03"></span>
                      </span>
                    </span>
                  </button>
                </p>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer class="Sessions-footer">
    <div class="u-inner">
      <p class="Sessions-text Sessions-text--footer u-txt-center"><%= link_to "Forgot password?", forget_password_url %> Â· <%= link_to 'Create an account', "https://cartodb.com/signup" %></p>
    </div>
  </footer>
</div>
