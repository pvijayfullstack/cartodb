@import '../variables/mixins';
@import '../variables/colors';
@import '../variables/sizes';
@import '../variables/onboarding';
@import '../editor-3/vars';
@import 'cdb-variables/colors';
@import 'cdb-variables/sizes';

$sSmallDescriptionWidth: 200px;
$sRegularDescriptionWidth: 445px;
$sBigDescriptionWidth: 550px;
$sWidgetsPadWidth: 378px;
$cBackgroundColor: #2E3C43;

// TODO: put variables to /variables/onboarding

$sToolbarWidth: 72px;
$sToolbarWidth-mediaXL: 48px;
$sEditorWidth: 344px;
$sWidgetsWidth: 368px;
$sWidgetsWidth-mediaXXL: 296px;

// TODO: put mixin to a common place
@mixin setStepPad($step, $padHeights, $selector, $tab) {
  .#{$selector}.is-#{$step}.#{$selector}--#{$tab} {
    @each $position, $height in $padHeights {
      .#{$selector}-pad#{$position} {
        height: map-get($padHeights, #{$position});
      }
    }
  }
}

.LayerOnboarding {
  @include display-flex();
  height: 100%;
  pointer-events: auto;
}

.LayerOnboarding-footer {
  margin-top: $sMargin-section;
}

.LayerOnboarding-footerButtons {
  margin-bottom: $sMargin-element;
}

.LayerOnboarding-contentWrapper {
  @include flex(1);
  @include display-flex();
  @include align-items(center);
  height: 100%;
  background: rgba($cBackgroundColor, 0.88);
  pointer-events: all;
  z-index: 5;
}
.LayerOnboarding-contentWrapper--analysis {
  @include justify-content(center);
}
.LayerOnboarding-body {
  position: absolute;
  left: 100%;
  margin-top: 45px;
  margin-left: 70px;
}

.LayerOnboarding-body.is-step3 {
  bottom: 36px;
}

.LayerOnboarding-body.is-step4 {
  right: 100%;
  left: auto;
  bottom: 36px;
}

.LayerOnboarding--style .LayerOnboarding-body.is-step2 {
  bottom: 36px;
}

.LayerOnboarding-contentBody {
  width: 0;
  margin: 0 80px;
  z-index: 20;
}

.LayerOnboarding-contentBody--analysis {
  width: auto;
}

.LayerOnboarding-forget,
.LayerOnboarding-header,
.LayerOnboarding-footer,
.LayerOnboarding-step {
  display: none;
}

.LayerOnboarding-footer .LayerOnboarding-footerButtons,
.LayerOnboarding-contentWrapper .LayerOnboarding-header p,
.LayerOnboarding-contentWrapper .LayerOnboarding-step p {
  @include opacity(1);
  @include transition(opacity, 200ms, ease-in-out, 1s);
}

.LayerOnboarding-header,
.LayerOnboarding-footer {
  min-width: 300px;
}

.LayerOnboarding.is-step0 .LayerOnboarding-header,
.LayerOnboarding.is-step0 .LayerOnboarding-footer.is-step0,
.LayerOnboarding.is-step1 .LayerOnboarding-footer.is-step1,
.LayerOnboarding.is-step2 .LayerOnboarding-footer.is-step2,
.LayerOnboarding.is-step3 .LayerOnboarding-footer.is-step3,
.LayerOnboarding.is-step4 .LayerOnboarding-footer.is-step4,
.LayerOnboarding.is-step0 .LayerOnboarding-step.is-step0,
.LayerOnboarding.is-step1 .LayerOnboarding-step.is-step1,
.LayerOnboarding.is-step2 .LayerOnboarding-step.is-step2,
.LayerOnboarding.is-step3 .LayerOnboarding-step.is-step3,
.LayerOnboarding.is-step4 .LayerOnboarding-step.is-step4 {
  display: block;
}

.LayerOnboarding-list {
  list-style-type: disc;
  padding-left: 2em;
  padding-top: 12px;
}

.LayerOnboarding-headerText {
  width: $sBigDescriptionWidth;
  line-height: 1.5em;
}

.LayerOnboarding-description {
  @include transition(width, 100ms, ease-in-out);
  width: $sRegularDescriptionWidth;
  margin-bottom: $sMargin-elementInline;
  color: #FFF;
  font-size: $sFontSize-large;
  font-weight: $sFontWeight-normal;
  line-height: $sLineHeight-large;
}

.LayerOnboarding-description--analysis,
.LayerOnboarding-description--style {
  width: $sBigDescriptionWidth;
}

.LayerOnboarding-toolbarOverlay,
.LayerOnboarding-widgetsOverlay,
.LayerOnboarding-pads {
  @include transition(width, 300ms, ease-in-out);
  height: 100%;
  z-index: 10;
}
.LayerOnboarding-pads {
  width: $sEditorWidth;
}

.LayerOnboarding-toolbarOverlay {
  width: $sToolbarWidth;
}

.LayerOnboarding-widgetsOverlay {
  width: $sWidgetsWidth;
  display: none;
}
.LayerOnboarding-widgetsOverlay.is-step4 {
  display: block;
}

.LayerOnboarding-padTop,
.LayerOnboarding-padMiddle,
.LayerOnboarding-padBottom {
  @include transition(height, 300ms, ease-in-out);
  width: 100%;
  display: block;
}

.LayerOnboarding-toolbarOverlay,
.LayerOnboarding-widgetsOverlay,
.LayerOnboarding-padTop,
.LayerOnboarding-padBottom {
  @include opacity(0.88);
  background: $cBackgroundColor;
}

.LayerOnboarding-padMiddle {
  @include opacity(1);
  position: relative;
  background: transparent;
}

$dataSteps: (
  step0: (
    Top: 0,
    Middle: 100%,
    Bottom: 0
  ),
  step1: (
    Top: 0,
    Middle: (19 + 64 + 21) * 1px,
    Bottom: 100%
  ),
  step2: (
    Top: (64 + 21) * 1px,
    Middle: calc(100% - (64 + 21 + 66) * 1px),
    Bottom: 66px
  ),
  step3: (
    Top: calc(100% - 66px),
    Middle: 66px,
    Bottom: 0
  ),
  step4: (
    Top: 100%,
    Middle: 0,
    Bottom: 0
  )
);

$stylePointsSteps: (
  step0: (
    Top: 0,
    Middle: 100%,
    Bottom: 0
  ),
  step1: (
    Top: 136px, // 19 + 85 + 32
    Middle: 173px, // 18 + 155
    Bottom: calc(100% - (136 + 173) * 1px)
  ),
  step2: (
    Top: (136 + 173 - 32) * 1px,
    Middle: 300px,
    Bottom: calc(100% - (136 + 173 - 32 + 300) * 1px)
  ),
  step3: (
    Top: calc(100% - 66px),
    Middle: 66px,
    Bottom: 0
  )
);

$styleSteps: (
  step0: (
    Top: 0,
    Middle: 100%,
    Bottom: 0
  ),
  step1: (
    Top: 136px,
    Middle: 300px,
    Bottom: calc(100% - 136px)
  ),
  step2: (
    Top: calc(100% - 66px),
    Middle: 66px,
    Bottom: 0
  )
);

@each $step, $heights in $dataSteps {
  @include setStepPad($step, $heights, 'LayerOnboarding', 'data');
}

@each $step, $heights in $stylePointsSteps {
  @include setStepPad($step, $heights, 'LayerOnboarding', 'stylePoints');
}

@each $step, $heights in $styleSteps {
  @include setStepPad($step, $heights, 'LayerOnboarding', 'style');
}

@each $step, $heights in $styleSteps {
  @include setStepPad($step, $heights, 'LayerOnboarding', 'analysis');
}

.LayerOnboarding--data .LayerOnboarding-pads--right {
  width: 150px;
  display: none;

  &.is-step0,
  &.is-step1,
  &.is-step2,
  &.is-step3 {
    .LayerOnboarding-padTop {
      height: 100%;
    }
    .LayerOnboarding-padMiddle {
      height: 0;
    }
    .LayerOnboarding-padBottom {
      height: 0;
    }
  }

  &.is-step4 {
    .LayerOnboarding-padTop {
      height: calc(100% - 100px);

      &.has-timeSeries {
        height: calc(100% - (100 + 143) * 1px); // 143 - XXXL time serie
      }
      &.has-timeSeries--animated {
        height: calc(100% - (100 + 166) * 1px); // 166 - XXXL animated
      }
    }
    .LayerOnboarding-padMiddle {
      height: 100px;
      background: transparent;
    }
    .LayerOnboarding-padBottom {
      height: 0;

      &.has-timeSeries {
        height: 143px;
      }
      &.has-timeSeries--animated {
        height: 166px;
      }
    }

    @media (max-width: $sViewport-xxl) {
      .LayerOnboarding-padTop {
        &.has-timeSeries {
          height: calc(100% - (100 + 127) * 1px); // 127 - XXL time serie
        }
        &.has-timeSeries--animated {
          height: calc(100% - (100 + 150) * 1px); // 150 - XXL animated
        }
      }
      .LayerOnboarding-padBottom {
        &.has-timeSeries {
          height: calc(100% - (100 + 127) * 1px);
        }
        &.has-timeSeries--animated {
          height: calc(100% - (100 + 150) * 1px);
        }
      }
    }

    @media (max-width: $sViewport-xl) {
      .LayerOnboarding-padTop {
        &.has-timeSeries {
          height: calc(100% - (100 + 119) * 1px); // 119 - XL time serie
        }
        &.has-timeSeries--animated {
          height: calc(100% - (100 + 142) * 1px); // 142 - XL animated
        }        
        &.has-widgets {
          height: calc(100% - (100 + 192) * 1px);

          &.has-timeSeries {
            height: calc(100% - (100 + 192 + 119) * 1px);
          }
          &.has-timeSeries--animated {
            height: calc(100% - (100 + 192 + 142) * 1px);
          }
        }
      }
      .LayerOnboarding-padBottom {
        &.has-timeSeries {
          height: calc(100% - (100 + 119) * 1px);
        }
        &.has-timeSeries--animated {
          height: calc(100% - (100 + 142) * 1px);
        }        
        &.has-widgets {
          height: 192px;

          &.has-timeSeries {
            height: (192 + 119) * 1px;
          }
          &.has-timeSeries--animated {
            height: (192 + 142) * 1px;
          }
        }
      }
    }
  }
}
.LayerOnboarding--data .LayerOnboarding-pads--right.is-step4 {
  display: block;
}


.LayerOnboarding-padBottom {
  position: relative;
}

.LayerOnboarding-forgetLabel {
  cursor: pointer;
}

@media (max-width: $sViewport-xxl) {
  .LayerOnboarding-widgetsOverlay {
    width: $sWidgetsWidth-mediaXXL;
  }
}

@media (max-width: $sViewport-xl) {
  .LayerOnboarding-toolbarOverlay {
    width: $sToolbarWidth-mediaXL;
  }

  .LayerOnboarding-widgetsOverlay {
    width: 0;
  }
}
